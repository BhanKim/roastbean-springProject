<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD 3.0//EN"
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.rb.base.dao.MypageDao">

	<select id="userInfoList" resultType="com.rb.base.model.UserDto">
		SELECT * from user where user_id = #{user_id}
	</select>
	
	<select id="userPwCheck" resultType="int">
		SELECT count(*) from user where user_id = #{user_id} and user_pw = #{user_pw} 
	</select>
	
	<update id="userInfoUpdate">
		UPDATE user set user_nick = #{user_nick}, user_telno = #{user_telno}, user_email = #{user_email}, user_addresszipcode = #{user_addresszipcode}, user_address1 = #{user_address1}, user_address2 = #{user_address2}, user_address3 = #{user_address3}, user_updatedate = now() where user_id = #{user_id}
	</update>
	
	<select id="myOrderList" resultType="com.rb.base.model.MyOrderListDto">
		select p.product_id, p.product_image, p.product_name, p.product_weight, o.order_seq, o.order_date, o.order_price, o.order_qty 
		from user u, product p, orders o  
		where u.user_id = #{user_id} and u.user_id = o.user_id and p.product_id = o.product_id 
		group by o.order_seq, p.product_id, o.order_date, o.order_price, o.order_qty
	</select>
	
	<select id="qnaList" resultType="com.rb.base.model.QnaDto">
		select qw.qna_write_category, qw.qna_write_title, qw.qna_write_seq, qw.qna_write_initdate, qw.qna_write_updatedate, 
			qw.qna_write_content, qwc.qna_write_comment_content, qwc.qna_write_comment_initdate, qwc.qna_write_comment_updatedate 
		from qna_write qw left join qna_write_comment qwc on qw.qna_write_seq = qwc.qna_write_comment_seq 
		where qw.user_id = #{user_id} order by qw.qna_write_seq desc
	</select>
	
</mapper>